{"ast":null,"code":"import _regeneratorRuntime from\"/Users/tomasboda/Documents/Workspace/React/edulabs/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Users/tomasboda/Documents/Workspace/React/edulabs/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _classCallCheck from\"/Users/tomasboda/Documents/Workspace/React/edulabs/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/Users/tomasboda/Documents/Workspace/React/edulabs/node_modules/@babel/runtime/helpers/esm/createClass\";import _assertThisInitialized from\"/Users/tomasboda/Documents/Workspace/React/edulabs/node_modules/@babel/runtime/helpers/esm/assertThisInitialized\";import _inherits from\"/Users/tomasboda/Documents/Workspace/React/edulabs/node_modules/@babel/runtime/helpers/esm/inherits\";import _createSuper from\"/Users/tomasboda/Documents/Workspace/React/edulabs/node_modules/@babel/runtime/helpers/esm/createSuper\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import React from\"react\";import{Link,withRouter}from\"react-router-dom\";import{setStorageItem,getStorageItem,removeStorageItem,isLogged}from\"../../config/Config\";import Api from\"../../config/Api\";import Loading from\"../../components/Loading\";import Panel from\"../../components/Panel\";import Heading from\"../../components/Heading\";import Box from\"../../components/Box\";import Edit from\"../../components/Edit\";import Option from\"../../components/Option\";import\"../../styles/admin.css\";import Icon from\"../../assets/login-icon.svg\";import ProfileIcon from\"../../assets/profile-icon.svg\";import AddIcon from\"../../assets/add-icon.svg\";var AdminClassroom=/*#__PURE__*/function(_React$Component){_inherits(AdminClassroom,_React$Component);var _super=_createSuper(AdminClassroom);function AdminClassroom(){var _this;_classCallCheck(this,AdminClassroom);_this=_super.call(this);_this.state={edit:false,type:\"add-user\",classroom:{},students:[],deletedUser:\"\",option:false,optionLoading:false,loading:true};_this.loadData=_this.loadData.bind(_assertThisInitialized(_this));_this.showOption=_this.showOption.bind(_assertThisInitialized(_this));_this.deleteUser=_this.deleteUser.bind(_assertThisInitialized(_this));return _this;}_createClass(AdminClassroom,[{key:\"loadData\",value:function(){var _loadData=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var token,id,getClassroom,getStudents,students,classroom;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:this.setState({loading:true});token=getStorageItem(\"token\");id=this.props.match.params.id;_context.next=5;return Api.getClassroom(id,token);case 5:getClassroom=_context.sent;_context.next=8;return Api.getAdminClassroomStudents(id,token);case 8:getStudents=_context.sent;console.log(getStudents);console.log(getClassroom);console.log(getStudents);if(getClassroom.classroom&&getStudents.students){students=getStudents.students;classroom=getClassroom.classroom;students.sort(function(a,b){return a.lastname.localeCompare(b.lastname);});this.setState({classroom:classroom,students:students,loading:false});}case 13:case\"end\":return _context.stop();}}},_callee,this);}));function loadData(){return _loadData.apply(this,arguments);}return loadData;}()},{key:\"showOption\",value:function showOption(event,id){event.stopPropagation();this.setState({deletedUser:id,option:true});}},{key:\"deleteUser\",value:function(){var _deleteUser=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(id){var _this2=this;var token,call;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:this.setState({optionLoading:true});token=getStorageItem(\"token\");_context2.next=4;return Api.deleteUser(id,token);case 4:call=_context2.sent;if(call.message===\"User deleted successfully\"){this.setState({option:false},function(){return _this2.loadData();});}case 6:case\"end\":return _context2.stop();}}},_callee2,this);}));function deleteUser(_x){return _deleteUser.apply(this,arguments);}return deleteUser;}()},{key:\"componentDidMount\",value:function componentDidMount(){this.loadData();}},{key:\"render\",value:function render(){var _this3=this;return/*#__PURE__*/_jsxs(\"div\",{className:\"screen\",id:\"admin-classroom\",children:[/*#__PURE__*/_jsx(Heading,{title:this.state.classroom.name?this.state.classroom.name:\"Loading\",withArrow:true}),/*#__PURE__*/_jsx(Panel,{title:\"Administrate your classroom\",text:\"Your classroom structure in one place. Assign students to this classroom, change the structure of it and update it as your school grows.\",image:Icon}),this.state.edit?/*#__PURE__*/_jsx(Edit,{type:this.state.type,classroom:this.state.classroom.id,role:\"student\",close:function close(){return _this3.setState({edit:false});},finish:function finish(){return _this3.setState({edit:false},function(){return _this3.loadData();});}}):null,this.state.loading?/*#__PURE__*/_jsx(\"div\",{className:\"fill-space\",children:/*#__PURE__*/_jsx(Loading,{})}):/*#__PURE__*/_jsxs(\"div\",{className:\"body-panel\",children:[/*#__PURE__*/_jsx(Box,{item:{name:\"Add student\"},icon:AddIcon,onClick:function onClick(){return _this3.setState({edit:true});}}),this.state.students.map(function(student,index){return/*#__PURE__*/_jsx(Box,{withAnimation:true,withRemove:true,onRemoveClick:function onRemoveClick(event){return _this3.showOption(event,student.id);},item:{name:student.firstname+\" \"+student.lastname},onClick:function onClick(){return _this3.props.history.push(\"/admin/users/\"+student.id);},icon:ProfileIcon});})]}),this.state.option?/*#__PURE__*/_jsx(Option,{title:\"Delete student?\",loading:this.state.optionLoading,onClick:function onClick(){return _this3.deleteUser(_this3.state.deletedUser);},close:function close(){return _this3.setState({option:false});}}):null]});}}]);return AdminClassroom;}(React.Component);export default withRouter(AdminClassroom);","map":{"version":3,"sources":["/Users/tomasboda/Documents/Workspace/React/edulabs/src/app/screens/admin/AdminClassroom.js"],"names":["React","Link","withRouter","setStorageItem","getStorageItem","removeStorageItem","isLogged","Api","Loading","Panel","Heading","Box","Edit","Option","AdminClassroom","state","edit","type","classroom","students","deletedUser","option","optionLoading","loading","loadData","bind","showOption","deleteUser","setState","token","id","props","match","params","getClassroom","getAdminClassroomStudents","getStudents","console","log","sort","a","b","lastname","localeCompare","event","stopPropagation","call","message","name","Icon","AddIcon","map","student","index","firstname","history","push","ProfileIcon","Component"],"mappings":"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","sourcesContent":["import React from \"react\";\nimport { Link, withRouter } from \"react-router-dom\";\n\nimport { setStorageItem, getStorageItem, removeStorageItem, isLogged } from \"../../config/Config\";\n\nimport Api from \"../../config/Api\";\nimport Loading from \"../../components/Loading\";\nimport Panel from \"../../components/Panel\";\nimport Heading from \"../../components/Heading\";\nimport Box from \"../../components/Box\";\nimport Edit from \"../../components/Edit\";\nimport Option from \"../../components/Option\";\n\nimport \"../../styles/admin.css\";\n\nimport Icon from \"../../assets/login-icon.svg\";\nimport ProfileIcon from \"../../assets/profile-icon.svg\";\nimport AddIcon from \"../../assets/add-icon.svg\";\n\nclass AdminClassroom extends React.Component {\n\n    state = {\n        edit: false,\n        type: \"add-user\",\n\n        classroom: {},\n        students: [],\n\n        deletedUser: \"\",\n        option: false,\n        optionLoading: false,\n\n        loading: true\n    }\n\n    constructor() {\n        super();\n\n        this.loadData = this.loadData.bind(this);\n        this.showOption = this.showOption.bind(this);\n        this.deleteUser = this.deleteUser.bind(this);\n    }\n\n    async loadData() {\n        this.setState({ loading: true });\n\n        const token = getStorageItem(\"token\");\n        const id = this.props.match.params.id;\n\n        const getClassroom = await Api.getClassroom(id, token);\n        const getStudents = await Api.getAdminClassroomStudents(id, token);\n        console.log(getStudents);\n\n        console.log(getClassroom);\n        console.log(getStudents);\n\n        if (getClassroom.classroom && getStudents.students) {\n            const students = getStudents.students;\n            const classroom = getClassroom.classroom;\n\n            students.sort((a, b) => {\n                return a.lastname.localeCompare(b.lastname);\n            });\n\n            this.setState({\n                classroom: classroom,\n                students: students,\n                loading: false\n            });\n        }\n    }\n\n    showOption(event, id) {\n        event.stopPropagation();\n\n        this.setState({\n            deletedUser: id,\n            option: true\n        });\n    }\n\n    async deleteUser(id) {\n        this.setState({ optionLoading: true });\n\n        const token = getStorageItem(\"token\");\n        const call = await Api.deleteUser(id, token);\n\n        if (call.message === \"User deleted successfully\") {\n            this.setState({ option: false }, () => this.loadData());\n        }\n    }\n\n    componentDidMount() {\n        this.loadData();\n    }\n\n    render() {\n        return(\n            <div className=\"screen\" id=\"admin-classroom\">\n                <Heading title={this.state.classroom.name ? this.state.classroom.name : \"Loading\"} withArrow />\n\n                <Panel\n                    title=\"Administrate your classroom\"\n                    text=\"Your classroom structure in one place. Assign students to this classroom, change the structure of it and update it as your school grows.\"\n                    image={Icon}\n                />\n\n                {this.state.edit ? (\n                    <Edit\n                        type={this.state.type}\n                        classroom={this.state.classroom.id}\n                        role=\"student\"\n                        close={() => this.setState({ edit: false })}\n                        finish={() => this.setState({ edit: false }, () => this.loadData())}\n                    />\n                ) : null}\n\n                {this.state.loading ? <div className=\"fill-space\"><Loading /></div> : (\n                    <div className=\"body-panel\">\n                        <Box\n                            item={{ name: \"Add student\" }}\n                            icon={AddIcon}\n                            onClick={() => this.setState({ edit: true })}\n                        />\n\n                        {this.state.students.map((student, index) => (\n                            <Box\n                                withAnimation\n                                withRemove\n                                onRemoveClick={(event) => this.showOption(event, student.id)}\n                                item={{ name: student.firstname + \" \" + student.lastname }}\n                                onClick={() => this.props.history.push(\"/admin/users/\" + student.id)}\n                                icon={ProfileIcon}\n                            />\n                        ))}\n                    </div>\n                )}\n\n                {this.state.option ? (\n                    <Option\n                        title=\"Delete student?\"\n                        loading={this.state.optionLoading}\n                        onClick={() => this.deleteUser(this.state.deletedUser)}\n                        close={() => this.setState({ option: false })}\n                    />\n                ) : null}\n            </div>\n        )\n    }\n}\n\nexport default withRouter(AdminClassroom);"]},"metadata":{},"sourceType":"module"}