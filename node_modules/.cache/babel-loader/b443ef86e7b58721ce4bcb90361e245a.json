{"ast":null,"code":"import _regeneratorRuntime from\"/Users/tomasboda/Documents/Workspace/React/edulabs/node_modules/@babel/runtime/regenerator\";import _objectSpread from\"/Users/tomasboda/Documents/Workspace/React/edulabs/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _asyncToGenerator from\"/Users/tomasboda/Documents/Workspace/React/edulabs/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _classCallCheck from\"/Users/tomasboda/Documents/Workspace/React/edulabs/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/Users/tomasboda/Documents/Workspace/React/edulabs/node_modules/@babel/runtime/helpers/esm/createClass\";import _assertThisInitialized from\"/Users/tomasboda/Documents/Workspace/React/edulabs/node_modules/@babel/runtime/helpers/esm/assertThisInitialized\";import _inherits from\"/Users/tomasboda/Documents/Workspace/React/edulabs/node_modules/@babel/runtime/helpers/esm/inherits\";import _createSuper from\"/Users/tomasboda/Documents/Workspace/React/edulabs/node_modules/@babel/runtime/helpers/esm/createSuper\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import React from\"react\";import{Link,withRouter}from\"react-router-dom\";import{setStorageItem,getStorageItem,removeStorageItem,isLogged}from\"../config/Config\";import{Grade}from\"../screens/Subject\";import Api from\"../config/Api\";import Loading from\"../components/Loading\";import Panel from\"../components/Panel\";import Heading from\"../components/Heading\";import\"../styles/grades.css\";import Icon from\"../assets/login-icon.svg\";var Grades=/*#__PURE__*/function(_React$Component){_inherits(Grades,_React$Component);var _super=_createSuper(Grades);function Grades(){var _this;_classCallCheck(this,Grades);_this=_super.call(this);_this.state={subjects:[],loading:true};_this.loadSubjects=_this.loadSubjects.bind(_assertThisInitialized(_this));return _this;}_createClass(Grades,[{key:\"loadSubjects\",value:function(){var _loadSubjects=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var token,call,array,i,add,getSubject,subjectId,getGrades,average,subject;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:this.setState({loading:true});token=getStorageItem(\"token\");_context.next=4;return Api.getUserSubjects(token);case 4:call=_context.sent;if(!call.subjects){_context.next=26;break;}array=[];i=0;case 8:if(!(i<call.subjects.length)){_context.next=23;break;}add=function add(a,b){return a+b.value;};_context.next=12;return Api.getSubject(call.subjects[i],token);case 12:getSubject=_context.sent;subjectId=getSubject.subject.id;_context.next=16;return Api.getGrades(subjectId,token);case 16:getGrades=_context.sent;average=getGrades.grades.reduce(add,0)/getGrades.grades.length;subject=_objectSpread(_objectSpread({},getSubject.subject),{},{grades:getGrades.grades,average:average});array.push(subject);case 20:i++;_context.next=8;break;case 23:this.setState({subjects:array,loading:false});_context.next=28;break;case 26:this.setState({loading:false});alert(\"ERROR\");case 28:case\"end\":return _context.stop();}}},_callee,this);}));function loadSubjects(){return _loadSubjects.apply(this,arguments);}return loadSubjects;}()},{key:\"componentDidMount\",value:function componentDidMount(){if(isLogged()){this.loadSubjects();}else{this.props.history.push(\"/\");}}},{key:\"render\",value:function render(){var _this2=this;var user=this.state.user;return/*#__PURE__*/_jsxs(\"div\",{className:\"screen\",id:\"grades\",children:[/*#__PURE__*/_jsx(Heading,{title:\"Grades\"}),/*#__PURE__*/_jsx(Panel,{title:\"Analyse and improve your results\",text:\"Welcome back to EduLabs. You have new assignments, homeworks and grades. Look them up in your notification panel.\",image:Icon}),/*#__PURE__*/_jsx(\"div\",{className:\"body-panel\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"panel\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"title-small\",children:\"Average grade by subject\"}),/*#__PURE__*/_jsx(\"div\",{className:\"grades\",children:this.state.subjects.map(function(subject,index){return/*#__PURE__*/_jsx(Grade,{title:subject.name,value:subject.average,style:index===_this2.state.subjects.length-1?{border:\"none\"}:null});})})]})})]});}}]);return Grades;}(React.Component);export default withRouter(Grades);","map":{"version":3,"sources":["/Users/tomasboda/Documents/Workspace/React/edulabs/src/app/screens/Grades.js"],"names":["React","Link","withRouter","setStorageItem","getStorageItem","removeStorageItem","isLogged","Grade","Api","Loading","Panel","Heading","Grades","state","subjects","loading","loadSubjects","bind","setState","token","getUserSubjects","call","array","i","length","add","a","b","value","getSubject","subjectId","subject","id","getGrades","average","grades","reduce","push","alert","props","history","user","Icon","map","index","name","border","Component"],"mappings":"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","sourcesContent":["import React from \"react\";\nimport { Link, withRouter } from \"react-router-dom\";\n\nimport { setStorageItem, getStorageItem, removeStorageItem, isLogged } from \"../config/Config\";\nimport { Grade } from \"../screens/Subject\";\n\nimport Api from \"../config/Api\";\nimport Loading from \"../components/Loading\";\nimport Panel from \"../components/Panel\";\nimport Heading from \"../components/Heading\";\n\nimport \"../styles/grades.css\";\n\nimport Icon from \"../assets/login-icon.svg\";\n\nclass Grades extends React.Component {\n\n    state = {\n        subjects: [],\n\n        loading: true\n    }\n\n    constructor() {\n        super();\n\n        this.loadSubjects = this.loadSubjects.bind(this);\n    }\n\n    async loadSubjects() {\n        this.setState({ loading: true });\n\n        const token = getStorageItem(\"token\");\n        const call = await Api.getUserSubjects(token);\n\n        if (call.subjects) {\n            var array = [];\n\n            for (let i = 0; i < call.subjects.length; i++) {\n                const getSubject = await Api.getSubject(call.subjects[i], token);\n                \n                const subjectId = getSubject.subject.id;\n                const getGrades = await Api.getGrades(subjectId, token);\n\n                function add(a, b) {\n                    return a + b.value;\n                }\n\n                const average = getGrades.grades.reduce(add, 0) / getGrades.grades.length;\n\n                const subject = {\n                    ...getSubject.subject,\n                    grades: getGrades.grades,\n                    average: average\n                }\n\n                array.push(subject);\n            }\n\n            this.setState({\n                subjects: array,\n                loading: false\n            });\n        } else {\n            this.setState({ loading: false });\n            alert(\"ERROR\");\n        }\n    }\n\n    componentDidMount() {\n        if (isLogged()) {\n            this.loadSubjects();\n        } else {\n            this.props.history.push(\"/\");\n        }\n    }\n\n    render() {\n        const user = this.state.user;\n\n        return(\n            <div className=\"screen\" id=\"grades\">\n                <Heading title=\"Grades\" />\n\n                <Panel\n                    title=\"Analyse and improve your results\"\n                    text=\"Welcome back to EduLabs. You have new assignments, homeworks and grades. Look them up in your notification panel.\"\n                    image={Icon}\n                />\n\n                <div className=\"body-panel\">\n                    <div className=\"panel\">\n                        <div className=\"title-small\">Average grade by subject</div>\n\n                        <div className=\"grades\">\n                            {this.state.subjects.map((subject, index) => (\n                                <Grade\n                                    title={subject.name}\n                                    value={subject.average}\n                                    style={index === this.state.subjects.length - 1 ? { border: \"none\" } : null}\n                                />\n                            ))}\n                        </div>\n                    </div>\n                </div>\n            </div>\n        )\n    }\n}\n\nexport default withRouter(Grades);"]},"metadata":{},"sourceType":"module"}