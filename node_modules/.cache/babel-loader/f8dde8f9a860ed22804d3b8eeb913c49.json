{"ast":null,"code":"import _regeneratorRuntime from\"/Users/tomasboda/Documents/Workspace/React/edulabs/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Users/tomasboda/Documents/Workspace/React/edulabs/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _classCallCheck from\"/Users/tomasboda/Documents/Workspace/React/edulabs/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/Users/tomasboda/Documents/Workspace/React/edulabs/node_modules/@babel/runtime/helpers/esm/createClass\";import _assertThisInitialized from\"/Users/tomasboda/Documents/Workspace/React/edulabs/node_modules/@babel/runtime/helpers/esm/assertThisInitialized\";import _inherits from\"/Users/tomasboda/Documents/Workspace/React/edulabs/node_modules/@babel/runtime/helpers/esm/inherits\";import _createSuper from\"/Users/tomasboda/Documents/Workspace/React/edulabs/node_modules/@babel/runtime/helpers/esm/createSuper\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import React from\"react\";import{withRouter,Link}from\"react-router-dom\";import{setStorageItem,getStorageItem,removeStorageItem,isLogged}from\"../config/Config\";import Api from\"../config/Api\";import Loading from\"../components/Loading\";import Panel from\"../components/Panel\";import Heading from\"../components/Heading\";import Box from\"../components/Box\";import\"../styles/subjects.css\";import Icon from\"../assets/login-icon.svg\";var Subjects=/*#__PURE__*/function(_React$Component){_inherits(Subjects,_React$Component);var _super=_createSuper(Subjects);function Subjects(){var _this;_classCallCheck(this,Subjects);_this=_super.call(this);_this.state={subjects:[],isTeacher:false,loading:true};_this.loadData=_this.loadData.bind(_assertThisInitialized(_this));_this.isTeacher=_this.isTeacher.bind(_assertThisInitialized(_this));return _this;}_createClass(Subjects,[{key:\"isTeacher\",value:function(){var _isTeacher=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var token,call;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:token=getStorageItem(\"token\");_context.next=3;return Api.getUser(token);case 3:call=_context.sent;if(!(call.user&&call.user.role===\"teacher\")){_context.next=6;break;}return _context.abrupt(\"return\",true);case 6:return _context.abrupt(\"return\",false);case 7:case\"end\":return _context.stop();}}},_callee);}));function isTeacher(){return _isTeacher.apply(this,arguments);}return isTeacher;}()},{key:\"loadData\",value:function(){var _loadData=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(){var token,call,fetchedSubjects,i,subjectId,subject;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:this.setState({loading:true});token=getStorageItem(\"token\");_context2.next=4;return Api.getUserSubjects(token);case 4:call=_context2.sent;if(!call.subjects){_context2.next=18;break;}fetchedSubjects=[];i=0;case 8:if(!(i<call.subjects.length)){_context2.next=17;break;}subjectId=call.subjects[i];_context2.next=12;return Api.getSubject(subjectId,token);case 12:subject=_context2.sent;fetchedSubjects.push(subject.subject);case 14:i++;_context2.next=8;break;case 17:this.setState({loading:false,subjects:fetchedSubjects});case 18:case\"end\":return _context2.stop();}}},_callee2,this);}));function loadData(){return _loadData.apply(this,arguments);}return loadData;}()},{key:\"componentDidMount\",value:function(){var _componentDidMount=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(){var teacher;return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:this.loadData();_context3.next=3;return this.isTeacher();case 3:teacher=_context3.sent;this.setState({isTeacher:teacher});case 5:case\"end\":return _context3.stop();}}},_callee3,this);}));function componentDidMount(){return _componentDidMount.apply(this,arguments);}return componentDidMount;}()},{key:\"render\",value:function render(){var _this2=this;return/*#__PURE__*/_jsxs(\"div\",{className:\"screen\",id:\"subjects\",children:[/*#__PURE__*/_jsx(Heading,{title:\"Subjects\"}),/*#__PURE__*/_jsx(Panel,{title:\"Dive into your subjects\",text:\"All your subjects in one place. Take a look at the results you achieved or the subjects you teach.\",image:Icon}),this.state.loading?/*#__PURE__*/_jsx(\"div\",{className:\"fill-space\",children:/*#__PURE__*/_jsx(Loading,{})}):/*#__PURE__*/_jsx(\"div\",{className:\"body-panel\",children:this.state.subjects.map(function(subject,index){return/*#__PURE__*/_jsx(Box//delay={index * 150}\n,{withAnimation:true,item:subject,onClick:function onClick(){return _this2.state.isTeacher?_this2.props.history.push(\"/subjects/\"+subject.id+\"/classrooms\"):_this2.props.history.push(\"/subjects/\"+subject.id);}});})})]});}}]);return Subjects;}(React.Component);export default withRouter(Subjects);","map":{"version":3,"sources":["/Users/tomasboda/Documents/Workspace/React/edulabs/src/app/screens/Subjects.js"],"names":["React","withRouter","Link","setStorageItem","getStorageItem","removeStorageItem","isLogged","Api","Loading","Panel","Heading","Box","Subjects","state","subjects","isTeacher","loading","loadData","bind","token","getUser","call","user","role","setState","getUserSubjects","fetchedSubjects","i","length","subjectId","getSubject","subject","push","teacher","Icon","map","index","props","history","id","Component"],"mappings":"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","sourcesContent":["import React from \"react\";\nimport { withRouter, Link } from \"react-router-dom\";\n\nimport { setStorageItem, getStorageItem, removeStorageItem, isLogged } from \"../config/Config\";\n\nimport Api from \"../config/Api\";\nimport Loading from \"../components/Loading\";\nimport Panel from \"../components/Panel\";\nimport Heading from \"../components/Heading\";\nimport Box from \"../components/Box\";\n\nimport \"../styles/subjects.css\";\n\nimport Icon from \"../assets/login-icon.svg\";\n\nclass Subjects extends React.Component {\n\n    state = {\n        subjects: [],\n\n        isTeacher: false,\n\n        loading: true\n    }\n\n    constructor() {\n        super();\n\n        this.loadData = this.loadData.bind(this);\n        this.isTeacher = this.isTeacher.bind(this);\n    }\n\n    async isTeacher() {\n        const token = getStorageItem(\"token\");\n        const call = await Api.getUser(token);\n\n        if (call.user && call.user.role === \"teacher\") return true;\n\n        return false;\n    }\n\n    async loadData() {\n        this.setState({ loading: true });\n\n        const token = getStorageItem(\"token\");\n\n        const call = await Api.getUserSubjects(token);\n\n        if (call.subjects) {\n            var fetchedSubjects = [];\n\n            for (let i = 0; i < call.subjects.length; i++) {\n                const subjectId = call.subjects[i];\n                const subject = await Api.getSubject(subjectId, token);\n                fetchedSubjects.push(subject.subject);\n            }\n\n            this.setState({\n                loading: false,\n                subjects: fetchedSubjects\n            });\n        }\n    }\n\n    async componentDidMount() {\n        this.loadData();\n\n        const teacher = await this.isTeacher();\n        this.setState({ isTeacher: teacher });\n    }\n\n    render() {\n        return(\n            <div className=\"screen\" id=\"subjects\">\n                <Heading title=\"Subjects\" />\n\n                <Panel\n                    title=\"Dive into your subjects\"\n                    text=\"All your subjects in one place. Take a look at the results you achieved or the subjects you teach.\"\n                    image={Icon}\n                />\n\n                {this.state.loading ? <div className=\"fill-space\"><Loading /></div> : (\n                    <div className=\"body-panel\">\n                        {this.state.subjects.map((subject, index) => (\n                            <Box\n                                //delay={index * 150}\n                                withAnimation\n                                item={subject}\n                                onClick={() => this.state.isTeacher ? this.props.history.push(\"/subjects/\" + subject.id + \"/classrooms\") : this.props.history.push(\"/subjects/\" + subject.id)}\n                            />\n                        ))}\n                    </div>\n                )}\n            </div>\n        )\n    }\n}\n\nexport default withRouter(Subjects);"]},"metadata":{},"sourceType":"module"}