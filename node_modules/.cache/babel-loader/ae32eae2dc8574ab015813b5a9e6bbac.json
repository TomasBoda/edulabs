{"ast":null,"code":"import _regeneratorRuntime from\"/Users/tomasboda/Documents/Workspace/React/edulabs/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Users/tomasboda/Documents/Workspace/React/edulabs/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _classCallCheck from\"/Users/tomasboda/Documents/Workspace/React/edulabs/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/Users/tomasboda/Documents/Workspace/React/edulabs/node_modules/@babel/runtime/helpers/esm/createClass\";import _assertThisInitialized from\"/Users/tomasboda/Documents/Workspace/React/edulabs/node_modules/@babel/runtime/helpers/esm/assertThisInitialized\";import _inherits from\"/Users/tomasboda/Documents/Workspace/React/edulabs/node_modules/@babel/runtime/helpers/esm/inherits\";import _createSuper from\"/Users/tomasboda/Documents/Workspace/React/edulabs/node_modules/@babel/runtime/helpers/esm/createSuper\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import React from\"react\";import{Link,withRouter}from\"react-router-dom\";import{setStorageItem,getStorageItem,removeStorageItem,isLogged}from\"../../config/Config\";import Api from\"../../config/Api\";import Loading from\"../../components/Loading\";import Panel from\"../../components/Panel\";import Heading from\"../../components/Heading\";import Box from\"../../components/Box\";import Edit from\"../../components/Edit\";import Popup from\"../../components/Popup\";import\"../../styles/admin.css\";import Icon from\"../../assets/login-icon.svg\";import ProfileIcon from\"../../assets/profile-icon.svg\";var AdminUser=/*#__PURE__*/function(_React$Component){_inherits(AdminUser,_React$Component);var _super=_createSuper(AdminUser);function AdminUser(){var _this;_classCallCheck(this,AdminUser);_this=_super.call(this);_this.state={user:{},firstname:\"\",lastname:\"\",email:\"\",role:\"\",admin:0,selectedStudentClassroom:\"\",selectedStudentSubjects:[],selectedTeacherSubjects:[],classrooms:[],subjects:[],teacherData:[],popup:false,message:\"Please fill in all blank spaces\",popupLoading:false,loading:true};_this.loadUserData=_this.loadUserData.bind(_assertThisInitialized(_this));_this.loadStudentSubjects=_this.loadStudentSubjects.bind(_assertThisInitialized(_this));_this.loadStudentClassrooms=_this.loadStudentClassrooms.bind(_assertThisInitialized(_this));_this.addStudentSubject=_this.addStudentSubject.bind(_assertThisInitialized(_this));_this.removeStudentSubject=_this.removeStudentSubject.bind(_assertThisInitialized(_this));_this.changeStudentClassroom=_this.changeStudentClassroom.bind(_assertThisInitialized(_this));_this.addTeacherSubject=_this.addTeacherSubject.bind(_assertThisInitialized(_this));_this.removeTeacherSubject=_this.removeTeacherSubject.bind(_assertThisInitialized(_this));_this.loadTeacherSubjectsAndClassrooms=_this.loadTeacherSubjectsAndClassrooms.bind(_assertThisInitialized(_this));_this.isTeached=_this.isTeached.bind(_assertThisInitialized(_this));return _this;}//////////////////////////////////\n_createClass(AdminUser,[{key:\"addStudentSubject\",value:function(){var _addStudentSubject=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(subjectId){var token,userId,call;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:token=getStorageItem(\"token\");userId=this.props.match.params.id;_context.next=4;return Api.addAdminStudentSubject({userId:userId,subjectId:subjectId,classroomId:this.state.selectedStudentClassroom},token);case 4:call=_context.sent;if(call.message===\"Subject added successfully\"){this.loadStudentSubjects();}case 6:case\"end\":return _context.stop();}}},_callee,this);}));function addStudentSubject(_x){return _addStudentSubject.apply(this,arguments);}return addStudentSubject;}()},{key:\"removeStudentSubject\",value:function(){var _removeStudentSubject=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(subjectId){var token,userId,call;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:token=getStorageItem(\"token\");userId=this.props.match.params.id;_context2.next=4;return Api.removeAdminStudentSubject({userId:userId,subjectId:subjectId,classroomId:this.state.selectedStudentClassroom},token);case 4:call=_context2.sent;if(call.message===\"Subject removed successfully\"){this.loadStudentSubjects();}case 6:case\"end\":return _context2.stop();}}},_callee2,this);}));function removeStudentSubject(_x2){return _removeStudentSubject.apply(this,arguments);}return removeStudentSubject;}()},{key:\"changeStudentClassroom\",value:function(){var _changeStudentClassroom=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(classroomId){var token,userId,call;return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:token=getStorageItem(\"token\");userId=this.props.match.params.id;_context3.next=4;return Api.changeAdminStudentClassroom({userId:userId,classroomId:classroomId},token);case 4:call=_context3.sent;if(call.message===\"Classroom changed successfully\"){this.loadUserData();}case 6:case\"end\":return _context3.stop();}}},_callee3,this);}));function changeStudentClassroom(_x3){return _changeStudentClassroom.apply(this,arguments);}return changeStudentClassroom;}()},{key:\"loadUserData\",value:function(){var _loadUserData=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee4(){var token,id,call;return _regeneratorRuntime.wrap(function _callee4$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:token=getStorageItem(\"token\");id=this.props.match.params.id;_context4.next=4;return Api.getAdminUser(id,token);case 4:call=_context4.sent;if(call.user){this.setState({user:call.user,firstname:call.user.firstname,lastname:call.user.lastname,email:call.user.email,role:call.user.role,admin:call.user.admin});if(call.user.role===\"student\"){this.setState({selectedStudentClassroom:call.user.classroom,loading:false});}}case 6:case\"end\":return _context4.stop();}}},_callee4,this);}));function loadUserData(){return _loadUserData.apply(this,arguments);}return loadUserData;}()},{key:\"loadStudentSubjects\",value:function(){var _loadStudentSubjects=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee5(){var token,id,allSubjects,studentSubjects,subjects;return _regeneratorRuntime.wrap(function _callee5$(_context5){while(1){switch(_context5.prev=_context5.next){case 0:token=getStorageItem(\"token\");id=this.props.match.params.id;_context5.next=4;return Api.getAdminSubjects(token);case 4:allSubjects=_context5.sent;_context5.next=7;return Api.getAdminUserSubjects(id,token);case 7:studentSubjects=_context5.sent;if(allSubjects.subjects&&studentSubjects.subjects){subjects=allSubjects.subjects;subjects.sort(function(a,b){return a.name.localeCompare(b.name);});this.setState({subjects:subjects,selectedStudentSubjects:studentSubjects.subjects});}case 9:case\"end\":return _context5.stop();}}},_callee5,this);}));function loadStudentSubjects(){return _loadStudentSubjects.apply(this,arguments);}return loadStudentSubjects;}()},{key:\"loadStudentClassrooms\",value:function(){var _loadStudentClassrooms=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee6(){var token,allClassrooms,classrooms;return _regeneratorRuntime.wrap(function _callee6$(_context6){while(1){switch(_context6.prev=_context6.next){case 0:token=getStorageItem(\"token\");_context6.next=3;return Api.getAdminClassrooms(token);case 3:allClassrooms=_context6.sent;if(allClassrooms.classrooms){classrooms=allClassrooms.classrooms;classrooms.sort(function(a,b){return a.name.localeCompare(b.name);});this.setState({classrooms:classrooms});}case 5:case\"end\":return _context6.stop();}}},_callee6,this);}));function loadStudentClassrooms(){return _loadStudentClassrooms.apply(this,arguments);}return loadStudentClassrooms;}()///////////////////////////////////\n},{key:\"addTeacherSubject\",value:function(){var _addTeacherSubject=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee7(subjectId,classroomId){var token,userId,call;return _regeneratorRuntime.wrap(function _callee7$(_context7){while(1){switch(_context7.prev=_context7.next){case 0:token=getStorageItem(\"token\");userId=this.props.match.params.id;_context7.next=4;return Api.addAdminTeacherSubject({userId:userId,subjectId:subjectId,classroomId:classroomId},token);case 4:call=_context7.sent;if(call.message===\"Subject added successfully\"){this.loadTeacherSubjectsAndClassrooms();}case 6:case\"end\":return _context7.stop();}}},_callee7,this);}));function addTeacherSubject(_x4,_x5){return _addTeacherSubject.apply(this,arguments);}return addTeacherSubject;}()},{key:\"removeTeacherSubject\",value:function(){var _removeTeacherSubject=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee8(subjectId,classroomId){var token,userId,call;return _regeneratorRuntime.wrap(function _callee8$(_context8){while(1){switch(_context8.prev=_context8.next){case 0:token=getStorageItem(\"token\");userId=this.props.match.params.id;_context8.next=4;return Api.removeAdminTeacherSubject({userId:userId,subjectId:subjectId,classroomId:classroomId},token);case 4:call=_context8.sent;if(call.message===\"Subject removed successfully\"){this.loadTeacherSubjectsAndClassrooms();}case 6:case\"end\":return _context8.stop();}}},_callee8,this);}));function removeTeacherSubject(_x6,_x7){return _removeTeacherSubject.apply(this,arguments);}return removeTeacherSubject;}()},{key:\"isTeached\",value:function isTeached(classroomId,subjectId){for(var i=0;i<this.state.teacherData.length;i++){var item=this.state.teacherData[i];if(item.classroom_id===classroomId&&item.subject_id===subjectId){return true;}}return false;}},{key:\"loadTeacherSubjectsAndClassrooms\",value:function(){var _loadTeacherSubjectsAndClassrooms=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee9(){var token,id,subjects,classrooms,call,fetchedClassrooms,fetchedSubjects;return _regeneratorRuntime.wrap(function _callee9$(_context9){while(1){switch(_context9.prev=_context9.next){case 0:token=getStorageItem(\"token\");id=this.props.match.params.id;_context9.next=4;return Api.getAdminSubjects(token);case 4:subjects=_context9.sent;_context9.next=7;return Api.getAdminClassrooms(token);case 7:classrooms=_context9.sent;_context9.next=10;return Api.getAdminTeacherSubjectsAndClassrooms(id,token);case 10:call=_context9.sent;console.log(call.data);console.log(classrooms.classrooms);console.log(subjects.subjects);if(call.data&&subjects.subjects&&classrooms.classrooms){fetchedClassrooms=classrooms.classrooms;fetchedSubjects=subjects.subjects;fetchedClassrooms.sort(function(a,b){return a.name.localeCompare(b.name);});fetchedSubjects.sort(function(a,b){return a.name.localeCompare(b.name);});this.setState({subjects:fetchedSubjects,classrooms:fetchedClassrooms,teacherData:call.data});}case 15:case\"end\":return _context9.stop();}}},_callee9,this);}));function loadTeacherSubjectsAndClassrooms(){return _loadTeacherSubjectsAndClassrooms.apply(this,arguments);}return loadTeacherSubjectsAndClassrooms;}()},{key:\"updateUser\",value:function(){var _updateUser=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee10(){var token,id,_this$state,firstname,lastname,email,admin,call;return _regeneratorRuntime.wrap(function _callee10$(_context10){while(1){switch(_context10.prev=_context10.next){case 0:this.setState({popup:true,popupLoading:true});token=getStorageItem(\"token\");id=this.props.match.params.id;_this$state=this.state,firstname=_this$state.firstname,lastname=_this$state.lastname,email=_this$state.email,admin=_this$state.admin;if(!(firstname.trim()===\"\"||lastname.trim()===\"\"||email.trim()===\"\")){_context10.next=7;break;}this.setState({popupLoading:false,message:\"Please fill in all blank spaces\"});return _context10.abrupt(\"return\");case 7:_context10.next=9;return Api.updateUserData(id,{firstname:firstname,lastname:lastname,email:email,admin:admin},token);case 9:call=_context10.sent;if(call.message===\"User data updated successfully\"){this.setState({popupLoading:false,message:\"User updated successfully\"});}case 11:case\"end\":return _context10.stop();}}},_callee10,this);}));function updateUser(){return _updateUser.apply(this,arguments);}return updateUser;}()},{key:\"componentDidMount\",value:function(){var _componentDidMount=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee11(){return _regeneratorRuntime.wrap(function _callee11$(_context11){while(1){switch(_context11.prev=_context11.next){case 0:this.setState({loading:true});_context11.next=3;return this.loadUserData();case 3:this.setState({loading:true});if(!(this.state.role===\"student\")){_context11.next=11;break;}_context11.next=7;return this.loadStudentClassrooms();case 7:_context11.next=9;return this.loadStudentSubjects();case 9:_context11.next=14;break;case 11:if(!(this.state.role===\"teacher\")){_context11.next=14;break;}_context11.next=14;return this.loadTeacherSubjectsAndClassrooms();case 14:this.setState({loading:false});case 15:case\"end\":return _context11.stop();}}},_callee11,this);}));function componentDidMount(){return _componentDidMount.apply(this,arguments);}return componentDidMount;}()},{key:\"render\",value:function render(){var _this2=this;if(this.state.loading){return/*#__PURE__*/_jsxs(\"div\",{className:\"screen\",id:\"admin-user\",children:[/*#__PURE__*/_jsx(Heading,{title:\"User\"}),/*#__PURE__*/_jsx(\"div\",{className:\"fill-space\",children:/*#__PURE__*/_jsx(Loading,{})})]});}return/*#__PURE__*/_jsxs(\"div\",{className:\"screen\",id:\"admin-user\",children:[/*#__PURE__*/_jsx(Heading,{title:\"User\",withArrow:true}),/*#__PURE__*/_jsxs(\"div\",{className:\"body-panel\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"panel top-panel\",children:[/*#__PURE__*/_jsx(\"img\",{className:\"profile-image\",src:ProfileIcon}),/*#__PURE__*/_jsxs(\"div\",{className:\"info-panel\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"name\",children:this.state.user.firstname+\" \"+this.state.user.lastname}),/*#__PURE__*/_jsx(\"div\",{className:\"role\",children:this.state.role===\"student\"?\"Student\":\"Teacher\"})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"bottom-panel\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"panel left-panel animate__animated animate__fadeInUp\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"title-small\",children:\"Personal info\"}),/*#__PURE__*/_jsx(\"div\",{style:{height:15}}),/*#__PURE__*/_jsx(\"input\",{className:\"input\",type:\"text\",placeholder:\"First name\",value:this.state.firstname,onChange:function onChange(event){return _this2.setState({firstname:event.target.value});}}),/*#__PURE__*/_jsx(\"input\",{className:\"input\",type:\"text\",placeholder:\"Last name\",value:this.state.lastname,onChange:function onChange(event){return _this2.setState({lastname:event.target.value});}}),/*#__PURE__*/_jsx(\"input\",{className:\"input\",type:\"text\",placeholder:\"E-mail\",value:this.state.email,onChange:function onChange(event){return _this2.setState({email:event.target.value});}}),/*#__PURE__*/_jsx(\"div\",{style:{height:20}}),/*#__PURE__*/_jsx(\"div\",{className:\"title-small\",children:\"Privileges\"}),/*#__PURE__*/_jsx(\"div\",{style:{height:20}}),/*#__PURE__*/_jsxs(\"div\",{className:\"button-panel\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"button\"+(this.state.admin===1?\"\":\"-disabled\"),onClick:function onClick(){return _this2.setState({admin:1});},children:\"Admin\"}),/*#__PURE__*/_jsx(\"div\",{style:{width:10}}),/*#__PURE__*/_jsx(\"div\",{className:\"button\"+(this.state.admin===0?\"\":\"-disabled\"),onClick:function onClick(){return _this2.setState({admin:0});},children:\"Regular\"})]}),/*#__PURE__*/_jsx(\"div\",{style:{flex:1}}),/*#__PURE__*/_jsx(\"div\",{className:\"button\",onClick:function onClick(){return _this2.updateUser();},style:{marginTop:30},children:\"Save changes\"})]}),this.state.role===\"student\"?/*#__PURE__*/_jsxs(\"div\",{className:\"right-panel animate__animated animate__fadeInUp animate__delay-1s\",id:\"student-panel\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"panel classroom-panel\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"title-small\",children:\"Classroom\"}),/*#__PURE__*/_jsx(\"div\",{className:\"list\",children:this.state.classrooms.map(function(classroom){return/*#__PURE__*/_jsx(\"div\",{className:\"item\",onClick:function onClick(){return _this2.changeStudentClassroom(classroom.id);},style:classroom.id===_this2.state.selectedStudentClassroom?{backgroundColor:\"#5E81F4\",color:\"white\"}:null,children:classroom.name});})})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"panel subject-panel\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"title-small\",children:\"Subjects\"}),/*#__PURE__*/_jsx(\"div\",{className:\"list\",children:this.state.subjects.map(function(subject){return/*#__PURE__*/_jsx(\"div\",{className:\"item\",onClick:function onClick(){return _this2.state.selectedStudentSubjects.includes(subject.id)?_this2.removeStudentSubject(subject.id):_this2.addStudentSubject(subject.id);},style:_this2.state.selectedStudentSubjects.includes(subject.id)?{backgroundColor:\"#5E81F4\",color:\"white\"}:null,children:subject.name});})})]})]}):/*#__PURE__*/_jsx(\"div\",{className:\"right-panel animate__animated animate__fadeInUp animate__delay-1s\",id:\"teacher-panel\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"panel classroom-panel\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"title-small\",children:\"Classrooms\"}),/*#__PURE__*/_jsx(\"div\",{className:\"classrooms\",children:this.state.classrooms.map(function(classroom){return/*#__PURE__*/_jsxs(\"div\",{className:\"classroom\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"info\",children:classroom.name}),/*#__PURE__*/_jsx(\"div\",{className:\"list\",children:_this2.state.subjects.map(function(subject){return/*#__PURE__*/_jsx(\"div\",{className:\"item\",onClick:function onClick(){return _this2.isTeached(classroom.id,subject.id)?_this2.removeTeacherSubject(subject.id,classroom.id):_this2.addTeacherSubject(subject.id,classroom.id);},style:_this2.isTeached(classroom.id,subject.id)?{backgroundColor:\"#5E81F4\",color:\"white\"}:null,children:subject.name});})})]});})})]})})]})]}),this.state.popup?/*#__PURE__*/_jsx(Popup,{loading:this.state.popupLoading,title:this.state.message,close:function close(){return _this2.setState({popup:false,loading:true},function(){return _this2.loadUserData();});}}):null]});}}]);return AdminUser;}(React.Component);export default withRouter(AdminUser);","map":{"version":3,"sources":["/Users/tomasboda/Documents/Workspace/React/edulabs/src/app/screens/admin/AdminUser.js"],"names":["React","Link","withRouter","setStorageItem","getStorageItem","removeStorageItem","isLogged","Api","Loading","Panel","Heading","Box","Edit","Popup","AdminUser","state","user","firstname","lastname","email","role","admin","selectedStudentClassroom","selectedStudentSubjects","selectedTeacherSubjects","classrooms","subjects","teacherData","popup","message","popupLoading","loading","loadUserData","bind","loadStudentSubjects","loadStudentClassrooms","addStudentSubject","removeStudentSubject","changeStudentClassroom","addTeacherSubject","removeTeacherSubject","loadTeacherSubjectsAndClassrooms","isTeached","subjectId","token","userId","props","match","params","id","addAdminStudentSubject","classroomId","call","removeAdminStudentSubject","changeAdminStudentClassroom","getAdminUser","setState","classroom","getAdminSubjects","allSubjects","getAdminUserSubjects","studentSubjects","sort","a","b","name","localeCompare","getAdminClassrooms","allClassrooms","addAdminTeacherSubject","removeAdminTeacherSubject","i","length","item","classroom_id","subject_id","getAdminTeacherSubjectsAndClassrooms","console","log","data","fetchedClassrooms","fetchedSubjects","trim","updateUserData","ProfileIcon","height","event","target","value","width","flex","updateUser","marginTop","map","backgroundColor","color","subject","includes","Component"],"mappings":"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","sourcesContent":["import React from \"react\";\nimport { Link, withRouter } from \"react-router-dom\";\n\nimport { setStorageItem, getStorageItem, removeStorageItem, isLogged } from \"../../config/Config\";\n\nimport Api from \"../../config/Api\";\nimport Loading from \"../../components/Loading\";\nimport Panel from \"../../components/Panel\";\nimport Heading from \"../../components/Heading\";\nimport Box from \"../../components/Box\";\nimport Edit from \"../../components/Edit\";\nimport Popup from \"../../components/Popup\";\n\nimport \"../../styles/admin.css\";\n\nimport Icon from \"../../assets/login-icon.svg\";\nimport ProfileIcon from \"../../assets/profile-icon.svg\";\n\nclass AdminUser extends React.Component {\n\n    state = {\n        user: {},\n\n        firstname: \"\",\n        lastname: \"\",\n        email: \"\",\n        role: \"\",\n        admin: 0,\n\n        selectedStudentClassroom: \"\",\n        selectedStudentSubjects: [],\n\n        selectedTeacherSubjects: [],\n\n        classrooms: [],\n        subjects: [],\n\n        teacherData: [],\n\n        popup: false,\n        message: \"Please fill in all blank spaces\",\n        popupLoading: false,\n\n        loading: true,\n    }\n\n    constructor() {\n        super();\n\n        this.loadUserData = this.loadUserData.bind(this);\n        \n        this.loadStudentSubjects = this.loadStudentSubjects.bind(this);\n        this.loadStudentClassrooms = this.loadStudentClassrooms.bind(this);\n        this.addStudentSubject = this.addStudentSubject.bind(this);\n        this.removeStudentSubject = this.removeStudentSubject.bind(this);\n        this.changeStudentClassroom = this.changeStudentClassroom.bind(this);\n\n        this.addTeacherSubject = this.addTeacherSubject.bind(this);\n        this.removeTeacherSubject = this.removeTeacherSubject.bind(this);\n        this.loadTeacherSubjectsAndClassrooms = this.loadTeacherSubjectsAndClassrooms.bind(this);\n        this.isTeached = this.isTeached.bind(this);\n    }\n\n    //////////////////////////////////\n\n    async addStudentSubject(subjectId) {\n        const token = getStorageItem(\"token\");\n        const userId = this.props.match.params.id;\n\n        const call = await Api.addAdminStudentSubject({\n            userId: userId,\n            subjectId: subjectId,\n            classroomId: this.state.selectedStudentClassroom\n        }, token);\n\n        if (call.message === \"Subject added successfully\") {\n            this.loadStudentSubjects();\n        }\n    }\n\n    async removeStudentSubject(subjectId) {\n        const token = getStorageItem(\"token\");\n        const userId = this.props.match.params.id;\n\n        const call = await Api.removeAdminStudentSubject({\n            userId: userId,\n            subjectId: subjectId,\n            classroomId: this.state.selectedStudentClassroom\n        }, token);\n\n        if (call.message === \"Subject removed successfully\") {\n            this.loadStudentSubjects();\n        }\n    }\n\n    async changeStudentClassroom(classroomId) {\n        const token = getStorageItem(\"token\");\n        const userId = this.props.match.params.id;\n\n        const call = await Api.changeAdminStudentClassroom({\n            userId: userId,\n            classroomId: classroomId\n        }, token);\n\n        if (call.message === \"Classroom changed successfully\") {\n            this.loadUserData();\n        }\n    }\n\n    async loadUserData() {\n        const token = getStorageItem(\"token\");\n        const id = this.props.match.params.id;\n\n        const call = await Api.getAdminUser(id, token);\n\n        if (call.user) {\n            this.setState({\n                user: call.user,\n\n                firstname: call.user.firstname,\n                lastname: call.user.lastname,\n                email: call.user.email,\n                role: call.user.role,\n                admin: call.user.admin,\n            });\n\n            if (call.user.role === \"student\") {\n                this.setState({\n                    selectedStudentClassroom: call.user.classroom,\n                    loading: false\n                });\n            }\n        }\n    }\n\n    async loadStudentSubjects() {\n        const token = getStorageItem(\"token\");\n        const id = this.props.match.params.id;\n\n        const allSubjects = await Api.getAdminSubjects(token);\n        const studentSubjects = await Api.getAdminUserSubjects(id, token);\n\n        if (allSubjects.subjects && studentSubjects.subjects) {\n            const subjects = allSubjects.subjects;\n            subjects.sort((a, b) => {\n                return a.name.localeCompare(b.name);\n            });\n\n            this.setState({\n                subjects: subjects,\n                selectedStudentSubjects: studentSubjects.subjects\n            });\n        }\n    }\n\n    async loadStudentClassrooms() {\n        const token = getStorageItem(\"token\");\n\n        const allClassrooms = await Api.getAdminClassrooms(token);\n\n        if (allClassrooms.classrooms) {\n            const classrooms = allClassrooms.classrooms;\n            classrooms.sort((a, b) => {\n                return a.name.localeCompare(b.name);\n            });\n\n            this.setState({\n                classrooms: classrooms\n            });\n        }\n    }\n\n    ///////////////////////////////////\n\n    async addTeacherSubject(subjectId, classroomId) {\n        const token = getStorageItem(\"token\");\n        const userId = this.props.match.params.id;\n\n        const call = await Api.addAdminTeacherSubject({\n            userId: userId,\n            subjectId: subjectId,\n            classroomId: classroomId\n        }, token);\n\n        if (call.message === \"Subject added successfully\") {\n            this.loadTeacherSubjectsAndClassrooms();\n        }\n    }\n\n    async removeTeacherSubject(subjectId, classroomId) {\n        const token = getStorageItem(\"token\");\n        const userId = this.props.match.params.id;\n\n        const call = await Api.removeAdminTeacherSubject({\n            userId: userId,\n            subjectId: subjectId,\n            classroomId: classroomId\n        }, token);\n\n        if (call.message === \"Subject removed successfully\") {\n            this.loadTeacherSubjectsAndClassrooms();\n        }\n    }\n\n    isTeached(classroomId, subjectId) {\n        for (let i = 0; i < this.state.teacherData.length; i++) {\n            const item = this.state.teacherData[i];\n\n            if (item.classroom_id === classroomId && item.subject_id === subjectId) {\n                return true;\n            }\n        }\n\n        return false;\n    }\n\n    async loadTeacherSubjectsAndClassrooms() {\n        const token = getStorageItem(\"token\");\n        const id = this.props.match.params.id;\n\n        const subjects = await Api.getAdminSubjects(token);\n        const classrooms = await Api.getAdminClassrooms(token);\n        const call = await Api.getAdminTeacherSubjectsAndClassrooms(id, token);\n\n        console.log(call.data);\n        console.log(classrooms.classrooms);\n        console.log(subjects.subjects);\n\n        if (call.data && subjects.subjects && classrooms.classrooms) {\n            const fetchedClassrooms = classrooms.classrooms;\n            const fetchedSubjects = subjects.subjects;\n\n            fetchedClassrooms.sort((a, b) => {\n                return a.name.localeCompare(b.name);\n            });\n\n            fetchedSubjects.sort((a, b) => {\n                return a.name.localeCompare(b.name);\n            });\n\n            this.setState({\n                subjects: fetchedSubjects,\n                classrooms: fetchedClassrooms,\n                teacherData: call.data\n            })\n        }\n    }\n\n    async updateUser() {\n        this.setState({ popup: true, popupLoading: true });\n\n        const token = getStorageItem(\"token\");\n\n        const id = this.props.match.params.id;\n        const { firstname, lastname, email, admin } = this.state;\n\n        if (firstname.trim() === \"\" || lastname.trim() === \"\" || email.trim() === \"\") {\n            this.setState({\n                popupLoading: false,\n                message: \"Please fill in all blank spaces\"\n            });\n\n            return;\n        }\n\n        const call = await Api.updateUserData(id, {\n            firstname: firstname,\n            lastname: lastname,\n            email: email,\n            admin: admin\n        }, token);\n\n        if (call.message === \"User data updated successfully\") {\n            this.setState({\n                popupLoading: false,\n                message: \"User updated successfully\"\n            });\n        }\n    }\n\n    async componentDidMount() {\n        this.setState({ loading: true });\n\n        await this.loadUserData();\n\n        this.setState({ loading: true });\n\n        if (this.state.role === \"student\") {\n            await this.loadStudentClassrooms();\n            await this.loadStudentSubjects();\n        } else if (this.state.role === \"teacher\") {\n            await this.loadTeacherSubjectsAndClassrooms();\n        }\n\n        this.setState({ loading: false });\n    }\n\n    render() {\n        if (this.state.loading) {\n            return(\n                <div className=\"screen\" id=\"admin-user\">\n                    <Heading title=\"User\" />\n\n                    <div className=\"fill-space\"><Loading /></div>\n                </div>\n            )\n        }\n\n        return(\n            <div className=\"screen\" id=\"admin-user\">\n                <Heading title=\"User\" withArrow />\n\n                <div className=\"body-panel\">\n                    <div className=\"panel top-panel\">\n                        <img className=\"profile-image\" src={ProfileIcon} />\n\n                        <div className=\"info-panel\">\n                            <div className=\"name\">{this.state.user.firstname + \" \" + this.state.user.lastname}</div>\n                            <div className=\"role\">{this.state.role === \"student\" ? \"Student\" : \"Teacher\"}</div>\n                        </div>\n                    </div>\n\n                    <div className=\"bottom-panel\">\n                        <div className=\"panel left-panel animate__animated animate__fadeInUp\">\n                            <div className=\"title-small\">Personal info</div>\n\n                            <div style={{ height: 15 }} />\n\n                            <input className=\"input\" type=\"text\" placeholder=\"First name\" value={this.state.firstname} onChange={(event) => this.setState({ firstname: event.target.value })} />\n                            <input className=\"input\" type=\"text\" placeholder=\"Last name\" value={this.state.lastname} onChange={(event) => this.setState({ lastname: event.target.value })} />\n                            <input className=\"input\" type=\"text\" placeholder=\"E-mail\" value={this.state.email} onChange={(event) => this.setState({ email: event.target.value })} />\n\n                            <div style={{ height: 20 }} />\n\n                            <div className=\"title-small\">Privileges</div>\n\n                            <div style={{ height: 20 }} />\n\n                            <div className=\"button-panel\">\n                                <div className={\"button\" + (this.state.admin === 1 ? \"\" : \"-disabled\")} onClick={() => this.setState({ admin: 1 })}>Admin</div>\n                                <div style={{ width: 10 }} />\n                                <div className={\"button\" + (this.state.admin === 0 ? \"\" : \"-disabled\")} onClick={() => this.setState({ admin: 0 })}>Regular</div>\n                            </div>\n\n                            <div style={{ flex: 1 }} />\n\n                            <div className=\"button\" onClick={() => this.updateUser()} style={{ marginTop: 30 }}>Save changes</div>\n                        </div>\n\n                        {this.state.role === \"student\" ? (\n                        <div className=\"right-panel animate__animated animate__fadeInUp animate__delay-1s\" id=\"student-panel\">\n                            <div className=\"panel classroom-panel\">\n                                <div className=\"title-small\">Classroom</div>\n\n                                <div className=\"list\">\n                                    {this.state.classrooms.map((classroom) => (\n                                        <div className=\"item\" onClick={() => this.changeStudentClassroom(classroom.id)} style={classroom.id === this.state.selectedStudentClassroom ? { backgroundColor: \"#5E81F4\", color: \"white\" } : null}>\n                                            {classroom.name}\n                                        </div>\n                                    ))}\n                                </div>\n                            </div>\n\n                            <div className=\"panel subject-panel\">\n                                <div className=\"title-small\">Subjects</div>\n\n                                <div className=\"list\">\n                                    {this.state.subjects.map((subject) => (\n                                        <div className=\"item\" onClick={() => this.state.selectedStudentSubjects.includes(subject.id) ? this.removeStudentSubject(subject.id) : this.addStudentSubject(subject.id)} style={this.state.selectedStudentSubjects.includes(subject.id) ? { backgroundColor: \"#5E81F4\", color: \"white\" } : null}>\n                                            {subject.name}\n                                        </div>\n                                    ))}\n                                </div>\n                            </div>\n                        </div>\n                        ) : (\n                        <div className=\"right-panel animate__animated animate__fadeInUp animate__delay-1s\" id=\"teacher-panel\">\n                            <div className=\"panel classroom-panel\">\n                                <div className=\"title-small\">Classrooms</div>\n\n                                <div className=\"classrooms\">\n                                    {this.state.classrooms.map((classroom) => (\n                                        <div className=\"classroom\">\n                                            <div className=\"info\">\n                                                {classroom.name}\n                                            </div>\n\n                                            <div className=\"list\">\n                                                {this.state.subjects.map((subject) => (\n                                                    <div className=\"item\"\n                                                        onClick={() => this.isTeached(classroom.id, subject.id) ? this.removeTeacherSubject(subject.id, classroom.id) : this.addTeacherSubject(subject.id, classroom.id)}\n                                                        style={this.isTeached(classroom.id, subject.id) ? { backgroundColor: \"#5E81F4\", color: \"white\" } : null}\n                                                    >\n                                                        {subject.name}\n                                                    </div>\n                                                ))}\n                                            </div>\n                                        </div>\n                                    ))}\n                                </div>\n                            </div>\n                        </div>\n                        )}\n                    </div>\n                </div>\n\n                {this.state.popup ? (\n                    <Popup\n                        loading={this.state.popupLoading}\n                        title={this.state.message}\n                        close={() => this.setState({ popup: false, loading: true }, () => this.loadUserData())}\n                    />\n                ) : null}\n            </div>\n        )\n    }\n}\n\nexport default withRouter(AdminUser);"]},"metadata":{},"sourceType":"module"}